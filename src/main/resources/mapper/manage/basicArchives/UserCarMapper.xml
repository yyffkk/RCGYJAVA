<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.api.manage.dao.basicArchives.UserCarDao">
    <select id="list" parameterType="com.api.model.basicArchives.SearchUserCar" resultType="com.api.vo.basicArchives.VoUserCar">
        select uc.*,cps.code as parking_space_code
        from user_car as uc,cpm_parking_space as cps
        <where>
            uc.parking_space_id = cps.id
            <if test="code != null and code != ''">
                and uc.code like concat('%',#{code},'%')
            </if>
            <if test="tel != null and tel != ''">
                and uc.tel like concat('%',#{tel},'%')
            </if>
            <if test="parkingSpaceCode != null and parkingSpaceCode != ''">
                and cps.code like concat('%',#{parkingSpaceCode},'%')
            </if>
        </where>
    </select>

    <insert id="insert" parameterType="com.api.model.basicArchives.UserCar">
        insert into
        <trim prefix="user_car(" suffix=")" suffixOverrides=",">
            id,
            building_unit_estate_id,
            <if test="type != null">
                type,
            </if>
            code,
            status,
            owner,
            <if test="idType != null">
                id_type,
            </if>
            <if test="idNumber != null and idNumber != ''">
                id_number,
            </if>
            <if test="tel != null and tel != ''">
                tel,
            </if>
            <if test="residentId != null">
                resident_id,
            </if>
            <if test="userId != null">
                user_id,
            </if>
            <if test="parkingSpaceId != null">
                parking_space_id,
            </if>
            create_id,
            create_date,
            <if test="effectiveTimeStart != null">
                effective_time_start,
            </if>
            <if test="effectiveTimeEnd != null">
                effective_time_end,
            </if>
        </trim>
        values
        <trim prefix="(" suffix=")" suffixOverrides=",">
            #{id},
            #{buildingUnitEstateId},
            <if test="type != null">
                #{type},
            </if>
            #{code},
            #{status},
            #{owner},
            <if test="idType != null">
                #{idType},
            </if>
            <if test="idNumber != null and idNumber != ''">
                #{idNumber},
            </if>
            <if test="tel != null and tel != ''">
                #{tel},
            </if>
            <if test="residentId != null">
                #{residentId},
            </if>
            <if test="userId != null">
                #{userId},
            </if>
            <if test="parkingSpaceId != null">
                #{parkingSpaceId},
            </if>
            #{createId},
            #{createDate},
            <if test="effectiveTimeStart != null">
                #{effectiveTimeStart},
            </if>
            <if test="effectiveTimeEnd != null">
                #{effectiveTimeEnd},
            </if>
        </trim>
    </insert>

    <select id="findById" parameterType="java.lang.Integer" resultType="com.api.vo.basicArchives.VoUserCarFindById">
        select uc.*,cps.code as parking_space_code
        from user_car as uc,cpm_parking_space as cps
        where uc.parking_space_id = cps.id and uc.id = #{id}
    </select>

    <update id="update" parameterType="com.api.model.basicArchives.UserCar">
        update user_car
        <set>
            <if test="buildingUnitEstateId != null">
                building_unit_estate_id = #{buildingUnitEstateId},
            </if>
            <if test="type != null">
                type = #{type},
            </if>
            <if test="code != null and code != ''">
                code = #{code},
            </if>
            <if test="status != null">
                status = #{status},
            </if>
            <if test="owner != null and owner != ''">
                owner = #{owner},
            </if>
            <if test="idType != null">
                id_type = #{idType},
            </if>
            <if test="idNumber != null and idNumber != ''">
                id_number = #{idNumber},
            </if>
            <if test="tel != null and tel != ''">
                tel = #{tel},
            </if>
                modify_id = #{modifyId},
                modify_date = #{modifyDate},
            <if test="effectiveTimeStart != null">
                effective_time_start = #{effectiveTimeStart},
            </if>
            <if test="effectiveTimeEnd != null">
                effective_time_end = #{effectiveTimeEnd},
            </if>
        </set>
        where id = #{id}
    </update>

    <delete id="delete" parameterType="java.lang.Integer">
        delete from user_car
        where id = #{id}
    </delete>
</mapper>